package faissextcode

/*
#include <duckdb.h>
#include <stdio.h>
duckdb_database db;
duckdb_connection con;
void init() {
	duckdb_config config;

	// create the configuration object
	if (duckdb_create_config(&config) == DuckDBError) {
		printf("unable to create config\n");
	}
	// set some configuration options
	duckdb_set_config(config, "allow_unsigned_extensions", "true"); // or READ_ONLY

	// open the database using the configuration
	if (duckdb_open_ext(NULL, &db, config, NULL) == DuckDBError) {
		printf("unable to open database\n");
	}
	if (duckdb_connect(db, &con) == DuckDBError) {
		printf("unable to open connection\n");
	}

	duckdb_state state;

	state = duckdb_query(con, "CREATE TABLE ids AS SELECT (i)::BIGINT AS id, (i%100)::BIGINT AS sel FROM range(0, 8841823) tbl(i)", NULL);
	if (state == DuckDBError) {
		printf("unable to create mod table\n");
	}

	state = duckdb_query(con, "LOAD json;", NULL);
	if (state == DuckDBError) {
		printf("unable to load json extension\n");
	}

	state = duckdb_query(con, "CREATE TABLE queries AS SELECT qid, vector AS embedding FROM 'conformanceTests/anserini-tools/topics-and-qrels/topics.dl19-passage.openai-ada2.jsonl'", NULL);
	if (state == DuckDBError) {
		printf("unable to create queries table\n");
	}

	state = duckdb_query(con, "CREATE TABLE queries2 AS SELECT qid, vector AS embedding FROM 'conformanceTests/anserini-tools/topics-and-qrels/topics.dl19-passage.openai-ada2.jsonl' LIMIT 1", NULL);
	if (state == DuckDBError) {
		printf("unable to create queries table\n");
	}
}

void init_faiss() {
	duckdb_state state;
	state = duckdb_query(con, "LOAD 'build/reldebug/extension/faiss/faiss.duckdb_extension';", NULL);
	if (state == DuckDBError) {
		printf("unable to load faiss\n");
	}

	state = duckdb_query(con, "CALL FAISS_LOAD('flat', 'indices/IDMap,HNSW128,Flat.index');", NULL);
	if (state == DuckDBError) {
		printf("unable to load faiss index\n");
	}
}

void deinit_faiss() {
	duckdb_state state;
	state = duckdb_query(con, "CALL FAISS_DESTROY('flat');", NULL);
	if (state == DuckDBError) {
		printf("unable to destroy faiss index\n");
	}
	fflush(stdout);
}

void init_vss() {
	duckdb_state state;

	state = duckdb_query(con, "LOAD vss", NULL);
	if (state == DuckDBError) {
		printf("unable to load vss\n");
	}

	state = duckdb_query(con, "CREATE TABLE input AS SELECT docid, vector FROM 'conformanceTests/msmarco-passage-openai-ada2/*.jsonl.gz';", NULL);
	if (state == DuckDBError) {
		printf("unable to load json extension\n");
	}

	state = duckdb_query(con, "ALTER TABLE input ALTER vector TYPE float[1536];", NULL);
	if (state == DuckDBError) {
		printf("unable to cast input table\n");
	}

	state = duckdb_query(con, "CREATE INDEX cos_idx ON input USING HNSW (vector) WITH (metric = 'ip');", NULL);
	if (state == DuckDBError) {
		printf("unable to load faiss index\n");
	}
	printf("finished vss init\n");
	fflush(stdout);
}

void deinit_vss() {
	duckdb_state state;
	state = duckdb_query(con, "DROP TABLE input;", NULL);
	if (state == DuckDBError) {
		printf("unable to drop table 'input'\n");
	}
	fflush(stdout);
}


void init_novss() {
	duckdb_state state;
	state = duckdb_query(con, "CREATE TABLE input2 AS SELECT docid, vector FROM 'conformanceTests/msmarco-passage-openai-ada2/*.jsonl.gz';", NULL);
	if (state == DuckDBError) {
		printf("unable to load input data\n");
	}

	state = duckdb_query(con, "ALTER TABLE input2 ALTER vector TYPE float[1536];", NULL);
	if (state == DuckDBError) {
		printf("unable to convert to float[1536]\n");
	}
	fflush(stdout);
}

void run_post(uint64_t N, uint32_t n, uint32_t p) {
	duckdb_result result;
	duckdb_state state;
	char *query = (char*)malloc(1000 * sizeof(char));
	sprintf(query, "SELECT * FROM (SELECT qid, UNNEST(faiss_search('flat', %d, embedding, MAP{'nprobe': '15'}), recursive:=true) FROM queries) JOIN ids ON label=id WHERE sel<%d", n, p);
	for (int i = 0; i < N; i++) {
		state = duckdb_query(con, query, &result);
		if (state == DuckDBError) {
			printf("unable to execute queries");
		}
		int resultn = duckdb_result_chunk_count(result);
		for (int i = 0; i < resultn; i++){
			duckdb_data_chunk chunk = duckdb_result_get_chunk(result, i);
			duckdb_destroy_data_chunk(&chunk);
		}
		duckdb_destroy_result(&result);
	}
}

void run_post_one(uint64_t N, uint32_t n, uint32_t p) {
	duckdb_result result;
	duckdb_state state;
	char *query = (char*)malloc(1000 * sizeof(char));
	sprintf(query, "SELECT * FROM (SELECT qid, UNNEST(faiss_search('flat', %d, embedding, MAP{'efsearch': '64'}), recursive:=true) FROM queries2) JOIN ids ON label=id WHERE sel<%d", n, p);
	for (int i = 0; i < N; i++) {
		state = duckdb_query(con, query, &result);
		if (state == DuckDBError) {
			printf("unable to execute queries");
		}
		int resultn = duckdb_result_chunk_count(result);
		for (int i = 0; i < resultn; i++){
			duckdb_data_chunk chunk = duckdb_result_get_chunk(result, i);
			duckdb_destroy_data_chunk(&chunk);
		}
		duckdb_destroy_result(&result);
	}
	free(query);
}

void run_sel(uint64_t N, uint32_t p) {
	duckdb_result result;
	duckdb_state state;
	char *query = (char*)malloc(1000 * sizeof(char));
	sprintf(query, "SELECT * FROM (SELECT qid, UNNEST(faiss_search_filter('flat', 10, embedding, 'sel<%d', 'rowid', 'ids', MAP{'nprobe': '15'}), recursive:=true) FROM queries) JOIN ids ON label=id WHERE sel<%d", p, p);
	for (int i = 0; i < N; i++) {
		state = duckdb_query(con, query, &result);
		if (state == DuckDBError) {
			printf("unable to execute queries");
		}
		int resultn = duckdb_result_chunk_count(result);
		for (int i = 0; i < resultn; i++){
			duckdb_data_chunk chunk = duckdb_result_get_chunk(result, i);
			duckdb_destroy_data_chunk(&chunk);
		}
		duckdb_destroy_result(&result);
	}
	free(query);
}

void run_set(uint64_t N, uint32_t p) {
	duckdb_result result;
	duckdb_state state;
	char *query = (char*)malloc(1000 * sizeof(char));
	sprintf(query, "SELECT * FROM (SELECT qid, UNNEST(faiss_search_filter_set('flat', 10, embedding, 'sel<%d', 'rowid', 'ids', MAP{'nprobe': '15'}), recursive:=true) FROM queries) JOIN ids ON label=id WHERE sel<%d", p, p);
	for (int i = 0; i < N; i++) {
		state = duckdb_query(con, query, &result);
		if (state == DuckDBError) {
			printf("unable to execute queries");
		}
		int resultn = duckdb_result_chunk_count(result);
		for (int i = 0; i < resultn; i++){
			duckdb_data_chunk chunk = duckdb_result_get_chunk(result, i);
			duckdb_destroy_data_chunk(&chunk);
		}
		duckdb_destroy_result(&result);
	}
	free(query);
}

void run_post_vss(uint64_t N, uint32_t n, uint32_t p) {
	duckdb_result result;
	duckdb_state state;
	char *query = (char*)malloc(1<<20 * sizeof(char));
	sprintf(query, "WITH t0 as (SELECT * FROM input ORDER BY array_negative_inner_product(vector, [-0.0057532666, 0.001803212, 0.0027337375, 0.0037084925, 0.0017122008, -0.008669026, -0.003548585, -0.002942978, -0.04738705, -0.008757486, -0.020699512, 0.007913719, -0.024809474, -0.0037527222, 0.024605338, -0.0001476805, 0.02312194, 0.012615679, 0.028769737, -0.025585195, -0.02535384, -0.010853294, -0.007416985, -0.011057432, 0.0060424614, 0.022740884, 0.010111596, -0.016875342, -0.0020090502, -0.0137588475, 0.003854791, 0.0076347315, -0.03350572, -0.028252589, -0.008845946, -0.02505444, -0.041262932, -0.018127384, 0.020155147, -0.00096114597, 0.00024368879, -0.0018100166, -0.0058519333, 0.030838327, 0.00063750346, -0.009308657, -0.020372894, -0.009186174, -0.029586285, 0.00681478, -0.00043761914, -0.024945566, -0.035601526, -0.004630512, -0.00806342, -0.008383234, 0.018903105, 0.0012716047, -0.0218699, -0.017596627, 0.010438216, 0.013037562, -0.024578119, 0.018794231, -0.016222103, 0.0041099624, -0.007274089, 0.001804913, -0.02154328, 0.016521504, 0.024686992, 0.016916169, -0.027871532, 0.0044433866, 0.025381058, -0.0059642084, 0.002636772, 0.005709037, 0.014929234, -0.0035519872, -0.0027218293, -0.027395213, -0.012098531, -0.010220469, 0.014970061, 0.017406099, -0.0074578123, 0.012629288, -0.020617858, -0.025421886, 0.005447061, 0.016698424, 0.028170934, 0.014167122, 0.006324851, -0.00657662, -0.023366906, 0.0075802947, 0.020536203, -0.018712576, -0.00094498513, 0.001566753, -0.024591729, -0.013500273, -0.0064745517, -0.009261024, -0.02056342, 0.008233534, 0.008961624, -0.008982037, -0.033560157, 0.0351116, -0.027204685, -0.01578661, 0.006477954, 0.0030059202, -0.011227546, -0.010989386, 0.0060118404, -0.020536203, 0.028415898, -0.017746327, 0.03816005, -0.04303212, 0.020794777, -0.00021285556, -0.018209038, 0.0012375818, -0.019202506, -0.012989931, 0.018835058, 0.010029941, -0.015582473, 0.01563691, 0.0052395216, 0.003131805, 0.02505444, -0.03111051, -0.029640721, -0.002089004, 0.0042188354, 0.0142896045, -0.02011432, -0.011479315, -0.003014426, -0.009744149, 0.04447469, 0.019882964, -0.00028876908, -0.013990203, 0.013792871, -0.019352207, -9.5104544e-05, -0.0149428435, -0.031790968, 0.00626361, -0.011540556, 0.048720747, 0.0017640856, -0.0067841597, -0.0022999458, -0.0032695974, 0.031056073, -0.007716386, 0.0019631195, 0.02137997, -0.007226457, 0.0153239, -0.0036268376, 0.01068318, 0.01514698, 0.018045729, -0.042814374, 0.012717748, 0.04572673, 0.018467613, -0.010751226, 0.002264222, -0.007702777, -0.0075054443, 0.014153513, -0.011390856, 0.040636912, 0.005719244, -0.02822537, 0.014153513, 0.050489936, 0.00965569, 0.031600438, -0.011656234, 0.014765924, 0.013282527, 0.014180731, -0.002585738, -0.6123027, -0.012016877, 0.024482856, -0.0136976065, 0.028796954, 0.0070427335, 0.022931412, -0.023162767, -0.000815273, 0.05451824, 0.010907731, -0.0098938495, 0.01307839, -0.0146298325, -0.030811109, -0.02904192, 0.011071041, 0.017637454, 0.042514976, -0.0139765935, -0.040609695, 0.012459174, -0.00084504293, 0.010172837, 0.023775179, 0.0013532595, 0.0017742926, 0.0073625483, 0.008594176, -0.012962712, -0.013343768, 0.009880241, 0.028933046, -0.00041592953, 0.037670117, -0.012302669, 0.0037186993, 0.022237346, 0.03478498, 0.0030705638, -0.026265653, 0.006787562, -0.008226729, 0.01060833, 0.0046679373, 6.448397e-05, -0.00666508, 0.0050932234, 0.009138542, 0.01609962, 0.0030807706, 0.007559881, -0.0008407901, 0.023026677, 0.02806206, -0.009444748, 0.001132111, -0.0028902425, 0.01867175, 0.009192979, -0.0010649158, -0.0052054985, -0.027204685, -0.03252586, -0.006515379, -0.014085467, -0.029940123, 0.012071313, 0.029014701, -0.015568864, 0.021026133, 0.023679916, 0.013391401, -0.00051587174, 0.0021332337, 0.0019631195, 0.010948558, 0.009363093, -0.013098803, 0.014452914, -0.020835605, -0.012098531, -0.029695159, -0.021965163, 0.029804032, -0.024183454, 0.0071992385, 0.002965093, -0.011064236, -0.01483397, -0.0010164331, 0.027381603, -0.024006534, -0.007784432, 0.008437671, 0.046216663, 0.008260752, -0.0036744697, -0.03592815, 0.0045522596, -0.01403103, 0.021325532, -0.0008441924, 0.029422976, 0.019556344, 0.009764562, -0.022890585, 0.03415896, 0.036281984, -0.028252589, -0.009560426, -0.0022982447, 0.0035553896, 0.003783343, 0.019352207, -0.032172024, 0.033723466, 0.010785249, 0.010662766, -0.031818185, 0.016684813, 0.022917803, 0.0049163043, 0.020141536, -0.00016256551, 0.008560154, 0.0002760105, -0.005035384, 0.002196176, -0.0052973605, -0.012683725, -0.012908276, 0.019692436, -0.0073897666, 0.013207677, 0.015718564, -0.0033631604, 0.0048142355, -0.019529125, -0.030593362, 0.006280621, -0.019855745, 4.6967503e-05, -0.03241699, -0.009927873, -0.01435765, 0.0030297362, 0.021407187, -0.020794777, -0.010812467, 0.02121666, -0.024047362, -0.037860647, -0.00051672227, -0.024863912, -0.024918348, -0.007525858, -0.007655145, -0.0087779, -0.0043617315, 0.010029941, 0.013112413, -0.007355744, 0.006253403, -0.009247416, -0.037915085, 0.022223737, 0.03960262, 0.012275451, -0.04305934, 0.0049435226, -0.0039670663, 0.021883508, 0.0048108334, 0.023802398, -0.021679372, -0.037071317, 0.024755038, 0.021243878, -0.011921613, 0.011771912, 0.011098259, -0.014058249, 0.013534296, 0.019569954, 0.0016475574, -0.0042154333, -0.017120307, -0.0328797, 0.017623845, -0.024823084, 0.011458902, -0.041888952, 0.02392488, 0.017501364, -0.016848125, -0.00053926243, 0.0057974965, -0.0025976459, -0.01658955, -0.0055559343, 0.0079001095, 0.02393849, -0.008219925, 0.015800219, -0.02137997, 0.012758575, 0.016698424, 0.02568046, 0.010826076, 0.0021638544, -0.001731764, 0.02920523, -0.03426783, -0.0025347036, 0.007382962, -0.0018695565, 0.011710671, 0.016861733, -0.0033189307, -0.012758575, -0.007825259, 0.018140992, 0.0111731095, -0.012377519, 0.025939034, 0.014874797, -0.009512793, -0.012568047, 0.0034686313, 0.0109553635, 0.0242515, 0.02091726, -0.0015454887, 0.009261024, -0.010077573, 0.01690256, -0.010676376, 0.015269463, -0.0018797634, -0.009247416, -0.001981832, 0.015541646, 0.008151879, 0.033587374, -0.0037323085, 0.0075530764, 0.03380512, 0.018630922, -0.001862752, -0.009478771, 0.0013192367, -0.027857924, 0.03162766, 0.02040011, -0.022795321, -0.0136976065, 0.014167122, 0.035029944, 0.010410997, 0.015487209, 0.039684273, 0.011431683, -0.006954274, -0.00018563727, -0.018753404, 0.003039943, -0.000220936, -0.014398477, 0.0047087646, -0.0005856186, -0.034403924, -0.0025296002, -0.0031301037, 0.021883508, 0.019324988, 0.016467068, 0.007308112, 0.030919982, 0.023013067, -0.003786745, 0.0019188897, 0.016453458, -0.01612684, -0.008716659, -0.019039197, -0.00025878643, 0.015010889, -0.0059540016, -0.0018797634, 0.005572946, -0.018889496, -0.00574306, 0.014316822, 0.018630922, -0.022359828, 0.026238436, -0.015296681, -0.025285795, 0.017923247, 0.02792597, -0.016426241, -0.020468157, -0.026047908, 0.02487752, -0.02358465, -0.030974418, -0.010968972, -0.020835605, -0.005620578, 0.017964074, -0.0065902295, -0.01434404, -0.013282527, 0.011302397, 0.0069882968, -0.029069137, -0.0032100575, 0.01754219, 0.007879696, 0.0012954207, 0.0046543283, -0.010159228, 0.012459174, 0.08965706, 0.002728634, -0.0010734214, 0.024455637, -0.0030348396, 0.0061309207, -0.020726731, -0.014956452, -0.0048040287, -0.0053347857, 0.023952099, -0.0030756672, 0.01333016, 0.0042188354, -0.012813012, -0.016834514, 0.017800763, -0.03380512, 0.016521504, 0.018535659, 0.022387046, -0.008471694, -0.0073897666, 0.027640177, 0.0028766333, 0.033723466, -0.0023935088, 0.017433317, 0.01864453, -0.03728906, -0.005293958, 0.028470336, -0.0018117176, 0.018426785, 0.015174199, -0.0030297362, 0.017964074, -0.014126294, 0.021570498, -0.02759935, 0.01962439, 0.003562194, 0.017909637, 0.0019971423, 0.017133916, -0.03701688, -0.0025125886, -0.0033767696, 0.013255309, 0.0047053625, 0.016970607, 0.0102068605, -0.014439304, -0.009383507, 0.023489388, 0.00079698564, -0.0032712987, 0.0050115683, -0.016167667, -0.0069372626, -0.027449649, -0.021788243, 0.042487755, -0.019011978, -0.011275178, -0.018032119, -0.03568318, -0.00059369905, -0.026837237, 0.0056886235, 0.0022284978, -0.009682908, -0.017759936, 0.01690256, 0.022101255, 0.008240338, 0.005055798, 0.015963528, -0.0026197608, 0.026782801, -0.0057022325, -0.032961354, -0.0064507355, -0.015745783, -0.027150247, 0.0037186993, -0.008532935, -0.006443931, -0.023081113, -0.0064031035, 0.016766468, 0.021570498, 0.036581386, -0.025911815, 0.017460536, 0.03568318, 0.017038653, 0.03413174, 0.011275178, -0.01196244, 0.012186991, 0.0063792877, -0.016371803, -0.023053894, 0.029749595, 0.0016586147, -0.021026133, 0.015514428, -0.012397933, -0.005729451, 0.054654334, -0.026701147, 0.023502996, 0.021801854, -0.008219925, 0.029422976, -0.025449105, 0.019256942, 0.02614317, -0.00095944485, -0.012663311, -0.02792597, 0.043630924, 0.011438488, -0.030375615, 0.0069951015, 0.013507078, -0.0026316687, -0.027327167, -0.0034244016, -0.0055967616, 0.042950466, 0.012744966, -0.037152972, -0.025639633, -0.00837643, -0.0063894945, 0.019665217, 0.0038684, -0.0025364046, -0.018263474, 0.004331111, 0.029286884, -0.008192706, 0.012670116, -0.0150381075, 0.003203253, -0.0056546004, 0.012955908, 0.004589685, 0.011288787, -0.00538582, -0.026374526, -0.0050966255, 0.001280961, 0.005909772, -0.02553076, -0.009696517, 0.021611325, 0.019842137, 0.012493197, 0.0027235304, -0.0132417, 0.006273817, 0.011928417, 0.0020702914, -0.006811378, 0.011418074, -0.027340775, 0.035002727, 0.05468155, 0.0011185018, -0.011799131, 0.021665761, -0.025911815, 0.03013065, 0.010948558, -0.042351663, -0.03206315, -0.040555257, -0.0014689373, -0.011043822, -0.013085195, 0.018576486, -0.03443114, -0.008968428, -0.0009050083, -0.0033410455, 0.016562331, -0.023339687, 0.02025041, 0.008403648, -0.004259663, 0.013350573, -0.0026299676, -0.009846218, -0.014153513, -0.009784977, -0.012690529, -0.008907187, -0.002264222, 0.0030331386, 0.018045729, -0.010342952, 0.005521911, -0.01035656, -0.04752314, -0.020985303, 0.010826076, -0.010376974, 0.019011978, -0.0037357109, -0.03015787, -0.011125478, 0.011220741, 0.010635548, -0.010989386, 0.040446386, -0.02091726, -0.007001906, 0.017514972, -0.026088735, 0.004528444, 0.0022999458, -0.0051544644, 0.02233261, -0.024591729, -0.010968972, -0.030048996, 0.024319544, -0.026701147, 0.022155691, 0.04003811, -0.002386704, -0.011275178, 0.0018712577, 0.023911271, -0.011479315, -0.033369627, 0.027136639, -0.012486393, 0.005089821, 0.0020702914, 0.00075743406, -0.021148615, 0.032852482, -0.027517695, -0.02137997, 0.0013473055, -0.015065325, -0.014847579, -0.00019105966, -0.02074034, 0.022876976, 0.00094753684, -0.018236257, -0.008070224, 0.018236257, -0.02584377, -0.00932907, -0.013132826, 0.028198153, -0.007015515, 0.00434472, 0.0093018515, -0.004831247, -0.01077164, -0.0066412636, -0.008321993, 0.035166036, 0.0076007084, -0.021624934, 0.0061003002, 0.017950464, 0.012214209, 0.015010889, 0.0011661338, -0.008607785, -0.0057124393, 0.003261092, 0.012629288, 0.025762115, -0.03396843, -0.00025347035, -0.0075190538, -0.014561787, -0.003654056, -0.011799131, 0.0067467345, -0.037044097, -0.025925424, 0.011152696, 0.006610643, 0.007940937, -0.0025772322, 0.015596082, 0.012227818, 0.012697334, -0.035138816, 0.017433317, -0.022373438, 0.01364317, -0.015650518, 0.015065325, -0.03816005, -0.06450736, 0.018290693, 0.0055559343, -0.026524227, -0.012806207, 0.0063894945, 0.0034448153, 0.020645076, -0.03271639, 0.044910185, -0.0076891677, 0.0047495924, -0.026578663, -0.031682093, 0.002313555, 0.004759799, -0.0022778308, -0.0019171885, 0.0069236537, 0.0050115683, -0.009961896, 0.025911815, -0.015582473, -0.012255036, -0.014099076, 0.0044535934, 0.0142896045, -0.02456451, -0.005732853, 0.010097987, 0.00187466, -0.024156235, 0.026333699, 0.014262386, -0.030048996, -0.005164671, -0.003524769, 0.00956723, 0.035302125, -0.017025042, 0.0015488911, -0.022087645, -0.013336964, 0.004933316, -0.01752858, 0.008832336, 0.047931414, 0.0106423525, 0.003725504, -0.013493469, -0.0032678964, -0.0153239, 0.0017981086, -0.0003125851, 0.02120305, 0.0142896045, 0.005113637, 0.015990747, 0.00054861873, 0.0065902295, -0.0013847307, -0.024265109, 0.0083356025, 0.0069951015, 0.021924336, 0.016385412, 0.015337508, -0.02694611, 0.0069576763, 0.048366908, -0.014112685, 0.005409636, 0.011778717, -0.029259665, -0.0032764021, -0.024496464, -0.0064507355, -0.008458084, 0.0200871, 0.041453462, -0.015691346, -0.032661952, 0.019093633, 0.013507078, -0.023149159, -0.004630512, 0.02136636, 0.02121666, 0.0039602616, -0.0072400663, -0.0016739251, 0.01944747, 0.029395757, -0.0027150249, 0.013561515, 0.0008526981, 0.024292327, -0.008247143, -0.007852478, 0.008968428, -0.014643442, -0.0079001095, -0.024850301, 0.00626361, -0.01563691, -0.016671205, -9.5051386e-05, 0.01913446, 0.013398205, 0.018862277, -0.010220469, -0.018072948, -0.023013067, -0.00403171, -0.0015769599, 0.0064983675, -0.0072808936, -0.0020277628, -0.0306478, 0.0041575944, -0.0074918354, 0.005637589, 0.0038615954, -0.010404193, 0.019678826, 0.0057974965, -0.0021655555, -0.0038207679, -0.008832336, -0.00070002046, 0.011105063, 0.18933044, -0.004732581, -0.026238436, 0.017256398, -0.009744149, 0.006328253, -0.014915625, 0.013030758, 0.0057362556, 0.013826893, 0.0052531306, 0.006430322, -0.039330434, -0.003334241, -0.012976321, -0.016984215, -0.020985303, -0.04164399, -0.00048312472, -0.007219652, -0.01707948, 0.0054538655, -0.010159228, -0.013602342, 0.044719655, 0.025966251, -0.031872623, 0.0099687, 0.037370715, -0.014017421, 0.0066276547, -0.0054776818, -0.014548178, 0.010172837, -0.0117038665, 0.013268918, 0.004674742, -0.008390039, -0.009784977, 0.014738706, 0.005566141, 0.020127928, -0.010009527, 0.0050728093, 0.0022778308, -0.002194475, -0.01752858, -0.015582473, 0.005140855, 0.018072948, -0.032798044, 0.02105335, 0.012969517, 0.014561787, 0.035819273, 0.034512796, 0.0034141948, 0.009580839, 0.0021638544, 0.017923247, -0.012540828, 0.021815462, -0.042514976, 0.013990203, 0.0016450057, 0.018222647, 0.002339072, 0.044447474, -0.008675831, 0.0025091865, -0.018576486, -0.034703325, -0.016194886, 0.009989114, -0.02695972, -0.005031982, 0.029232448, 0.03162766, 0.017759936, 0.04706043, -0.019270552, 0.024850301, -0.035438217, -0.020100709, 0.006821585, -0.052694615, 0.0045114323, -0.0022540148, -0.00016968905, 0.019107241, 0.03140991, -0.028606426, -0.0074714217, -0.020019054, 0.029776813, 0.002766059, -0.010792053, 0.029314103, -0.021461625, 0.0015735576, -0.018590095, 0.06733806, -0.0030093226, 0.0084308665, -0.0062840236, -0.016739251, 0.019093633, 0.025639633, 0.01897115, -0.019583562, -0.012772184, -0.034213394, 0.013091999, -0.0024224282, 0.009526403, 0.011445292, 0.008070224, -0.010968972, 0.02358465, -0.01675286, -0.0026912089, -0.008920795, 0.014779533, 0.018249866, -0.011009799, 0.022196518, 0.028960265, -0.008648613, -0.0074918354, -0.030892763, 0.017161135, -0.038949378, 0.0050387867, -0.027980406, -0.01045863, -0.02120305, -0.00187466, -0.030838327, -0.014752315, -0.017637454, 0.0071039745, -0.0075326627, -0.0149428435, 0.002834105, 0.010200055, -0.022278173, 0.034077305, -0.010819272, -0.017474145, 0.035166036, -0.024972785, -0.010315733, 0.0077776276, -0.018943932, 0.026687536, -0.015881874, -0.052558526, -0.04787698, 0.0022693253, 0.008771095, -0.03783343, -0.003157322, 0.034567233, -0.03301579, 0.017583018, 0.016303757, -0.1712575, 0.02664671, 0.027612958, -0.011479315, 0.028579209, -0.003135207, -0.00047504427, -0.016548723, -0.01068318, 0.0042664674, 0.009546816, -0.016031574, -0.015133372, -0.004331111, -0.022890585, -0.01865814, 0.0021536474, 0.006882826, 0.024006534, -0.0038207679, 0.023040285, -0.009063692, -0.008982037, -0.005722646, -0.0090841055, -0.021638544, -0.014820361, 0.0022863366, 0.008757486, 0.008771095, 0.0046066963, -0.016249321, -0.0015080636, -0.019760482, 0.0059914268, 0.0052157054, -0.006110507, -0.007716386, -0.01819543, 0.0062091732, 0.03568318, 0.01819543, 0.005977818, -0.006716114, -0.026442572, 0.0011805935, 0.013622756, 0.012078118, 0.009880241, -0.0041371807, -0.012248232, -0.010785249, 0.007607513, -0.009077301, -0.00733533, -0.0111731095, -0.008458084, 0.009192979, -0.022210127, 0.0123503, -0.0015046613, -0.009247416, 0.0054028314, 0.025884597, -0.031682093, 0.005021775, -0.004239249, -0.0117038665, -0.014888407, -0.0005307567, -0.026551446, -0.017120307, -0.0033291376, -0.013881329, 0.026279263, -0.00091691624, 0.010329342, -0.0020090502, 0.00766195, -0.011350028, 0.029123574, 0.021815462, -0.010826076, -0.008498912, -0.004885684, 0.006443931, 0.029531848, 0.0022574172, 0.028252589, -0.019161679, 0.02728634, -0.018481221, 0.008015787, -0.01364317, 0.0015284773, 0.01882145, 0.012520415, -0.011663039, 0.013057976, -0.028307026, 0.015174199, 0.0067229187, -0.029695159, 0.0073965713, 0.03666304, -0.0019631195, 0.021638544, 0.0058961627, 0.04142624, -0.017610235, 0.0018117176, 0.032852482, 0.01898476, 0.029395757, 0.01672564, 0.0037969518, 0.006869217, 0.006267012, 0.012615679, -0.045672297, 0.05530757, 0.01124796, -0.027163858, 0.0047291787, 0.023258032, -0.014153513, -0.12749049, -0.06309201, 0.02725912, 0.033396848, -0.0026299676, 0.015010889, -0.015500818, 0.02233261, -0.0092406105, 0.0373435, -0.0035383783, -0.027231902, -0.004416168, -0.003356356, 0.018535659, 0.01212575, 0.00037999288, -0.048121944, 0.0039228364, 0.033832338, 0.024129018, 0.0011491224, -0.009029669, 0.010302125, -0.0007991121, -0.017977683, -0.015909093, -0.0060560703, 0.0019290965, 0.0010674675, 0.008594176, -0.032852482, 0.0027456454, -0.017365271, -0.015868265, 0.0006566413, -0.03639086, -0.01786881, 0.015568864, -0.0076891677, 0.014548178, 0.001946108, 0.0015080636, -0.017501364, -0.024673384, -0.019556344, -0.027585741, -0.013289331, -0.009859826, -0.013602342, -0.0015505921, -0.017664673, -0.024373982, -0.008417257, 0.020903649, -0.022686448, -0.009363093, 0.018698968, -0.01092134, -0.014412086, 0.007981764, -0.0064949654, -0.0016160862, 0.034730542, -0.018413175, -0.024047362, -0.03364181, 0.021026133, -0.020209583, -0.013609147, 0.008546544, 0.004518237, -0.010968972, -2.7377775e-05, -0.03941209, -0.011710671, -0.027163858, -0.010349756, -0.009192979, -0.006015243, -0.010166032, -0.0023986122, 0.011377247, -0.021080568, 0.006821585, 0.020195974, -0.0007157561, -0.0073761577, -0.009199783, -0.0077436045, 0.020236801, 0.014003812, -0.0034482176, 0.0029225643, 0.015596082, 0.0020362686, -0.008532935, -0.0018287291, 0.000984962, -0.016657596, -0.00363024, 0.013792871, -0.021761026, 0.0058349217, -0.0009084105, -0.014657051, 0.0054640723, -0.013935766, -0.014929234, -0.007879696, -0.00028643, -0.014425696, -0.029722376, -0.0029395758, 0.005977818, 0.0031130924, -0.020345675, -0.01864453, 0.0177055, -0.0059846225, 0.011193523, 0.022128472, -0.03494829, 0.0012163175, 0.0098938495, -0.0033971833, -0.011799131, -0.02074034, 0.0068658143, -0.00018733842, -0.015283071, -0.01371802, 0.023666305, -0.019529125, -0.0015854656, 0.007668754, 0.006222782, -0.009192979, -0.013425424, 0.0041235713, 0.008975232, 0.029450193, -0.03189984, -0.033369627, 0.00562398, -0.005372211, 0.0093018515, 0.0026248642, -0.032008715, 0.024292327, -0.009887045, -0.03323354, 0.026211217, 0.017324444, 0.010193251, -0.025612414, -0.012629288, -0.0026741973, -0.009737344, -0.010240883, 0.0072808936, -0.02074034, 0.021774635, 0.019692436, -0.03127382, -0.0059540016, 0.002242107, 6.8112186e-06, 2.4148261e-05, 0.04115406, -0.014616224, -0.0013974892, -0.019569954, 0.006161541, 0.0045998916, 0.007124388, 0.012989931, 0.0028204957, 0.007709582, 0.006362276, -0.02344856, 0.021910727, -0.0034618268, -0.0016126839, -0.014180731, 0.0009050083, -0.009553621, 0.014793143, -0.017596627, 0.011629016, 0.02358465, 0.025626024, -0.03315188, 0.009737344, -0.0018882691, -0.00916576, 0.03783343, 0.013724824, 0.0090841055, -0.0004414467, -0.0011848464, 0.00051842345, -0.024659773, -0.01578661, -0.01212575, -0.025898207, -0.012445564, 0.011268374, -0.022536747, -0.0066548726, 0.020032665, -0.005542325, -0.014765924, -0.0010189848, -0.010254492, 0.025612414, -0.04929233, -0.01212575, -0.0131056085, -0.03475776, -0.02280893, 0.022523139, 0.013187263, 0.025435496, 0.005766876, 0.023407733, -0.006443931, 0.0012180186, 0.004079342, -0.009574035, -0.0139153525, 0.009764562, -0.008321993, -0.0068079755, -0.022591183, -0.011241156, -0.009628471, -0.014058249, 0.014058249, 0.022849757, -0.01754219, 0.08143713, 0.012132554, 0.00019318609, 0.0112343505, -0.027953187, 0.012649702, 0.005521911, 0.0014289604, 0.0026044506, -0.028524771, 0.043767016, -0.019011978, 0.005974415, -0.00093733, -0.026537836, 0.008907187, -0.012112141, 0.0124183465, 0.00087864057, 0.0025721288, 0.02040011, -0.008566958, 0.032798044, 0.00813827, 0.006967883, 0.003381873, 0.02920523, -0.015609691, 0.00016394768, -0.014221558, 0.0023220608, 0.014126294, -0.02792597, 0.009043278, 0.036091458, -0.021407187, -0.023053894, 6.8909594e-06, -0.012935494, 0.003107989, 0.028742518, 0.0071924343, -0.011166305, -0.016807295, 0.007178825, -0.030430052, -0.032498643, 0.009995919, -0.012493197]::FLOAT[1536]) LIMIT %d) SELECT * FROM t0 JOIN ids ON CAST(docid AS INT)=id WHERE sel<%d", n, p);
	for (int i = 0; i < N; i++) {
		state = duckdb_query(con, query, &result);
		if (state == DuckDBError) {
			printf("unable to execute queries");
		}
		int resultn = duckdb_result_chunk_count(result);
		for (int i = 0; i < resultn; i++){
			duckdb_data_chunk chunk = duckdb_result_get_chunk(result, i);
			duckdb_destroy_data_chunk(&chunk);
		}
		duckdb_destroy_result(&result);
	}
}

void run_post_novss(uint64_t N, uint32_t n, uint32_t p) {
	duckdb_result result;
	duckdb_state state;
	char *query = (char*)malloc(1<<20 * sizeof(char));
	sprintf(query, "WITH t0 as (SELECT * FROM input2 ORDER BY array_negative_inner_product(vector, [-0.0057532666, 0.001803212, 0.0027337375, 0.0037084925, 0.0017122008, -0.008669026, -0.003548585, -0.002942978, -0.04738705, -0.008757486, -0.020699512, 0.007913719, -0.024809474, -0.0037527222, 0.024605338, -0.0001476805, 0.02312194, 0.012615679, 0.028769737, -0.025585195, -0.02535384, -0.010853294, -0.007416985, -0.011057432, 0.0060424614, 0.022740884, 0.010111596, -0.016875342, -0.0020090502, -0.0137588475, 0.003854791, 0.0076347315, -0.03350572, -0.028252589, -0.008845946, -0.02505444, -0.041262932, -0.018127384, 0.020155147, -0.00096114597, 0.00024368879, -0.0018100166, -0.0058519333, 0.030838327, 0.00063750346, -0.009308657, -0.020372894, -0.009186174, -0.029586285, 0.00681478, -0.00043761914, -0.024945566, -0.035601526, -0.004630512, -0.00806342, -0.008383234, 0.018903105, 0.0012716047, -0.0218699, -0.017596627, 0.010438216, 0.013037562, -0.024578119, 0.018794231, -0.016222103, 0.0041099624, -0.007274089, 0.001804913, -0.02154328, 0.016521504, 0.024686992, 0.016916169, -0.027871532, 0.0044433866, 0.025381058, -0.0059642084, 0.002636772, 0.005709037, 0.014929234, -0.0035519872, -0.0027218293, -0.027395213, -0.012098531, -0.010220469, 0.014970061, 0.017406099, -0.0074578123, 0.012629288, -0.020617858, -0.025421886, 0.005447061, 0.016698424, 0.028170934, 0.014167122, 0.006324851, -0.00657662, -0.023366906, 0.0075802947, 0.020536203, -0.018712576, -0.00094498513, 0.001566753, -0.024591729, -0.013500273, -0.0064745517, -0.009261024, -0.02056342, 0.008233534, 0.008961624, -0.008982037, -0.033560157, 0.0351116, -0.027204685, -0.01578661, 0.006477954, 0.0030059202, -0.011227546, -0.010989386, 0.0060118404, -0.020536203, 0.028415898, -0.017746327, 0.03816005, -0.04303212, 0.020794777, -0.00021285556, -0.018209038, 0.0012375818, -0.019202506, -0.012989931, 0.018835058, 0.010029941, -0.015582473, 0.01563691, 0.0052395216, 0.003131805, 0.02505444, -0.03111051, -0.029640721, -0.002089004, 0.0042188354, 0.0142896045, -0.02011432, -0.011479315, -0.003014426, -0.009744149, 0.04447469, 0.019882964, -0.00028876908, -0.013990203, 0.013792871, -0.019352207, -9.5104544e-05, -0.0149428435, -0.031790968, 0.00626361, -0.011540556, 0.048720747, 0.0017640856, -0.0067841597, -0.0022999458, -0.0032695974, 0.031056073, -0.007716386, 0.0019631195, 0.02137997, -0.007226457, 0.0153239, -0.0036268376, 0.01068318, 0.01514698, 0.018045729, -0.042814374, 0.012717748, 0.04572673, 0.018467613, -0.010751226, 0.002264222, -0.007702777, -0.0075054443, 0.014153513, -0.011390856, 0.040636912, 0.005719244, -0.02822537, 0.014153513, 0.050489936, 0.00965569, 0.031600438, -0.011656234, 0.014765924, 0.013282527, 0.014180731, -0.002585738, -0.6123027, -0.012016877, 0.024482856, -0.0136976065, 0.028796954, 0.0070427335, 0.022931412, -0.023162767, -0.000815273, 0.05451824, 0.010907731, -0.0098938495, 0.01307839, -0.0146298325, -0.030811109, -0.02904192, 0.011071041, 0.017637454, 0.042514976, -0.0139765935, -0.040609695, 0.012459174, -0.00084504293, 0.010172837, 0.023775179, 0.0013532595, 0.0017742926, 0.0073625483, 0.008594176, -0.012962712, -0.013343768, 0.009880241, 0.028933046, -0.00041592953, 0.037670117, -0.012302669, 0.0037186993, 0.022237346, 0.03478498, 0.0030705638, -0.026265653, 0.006787562, -0.008226729, 0.01060833, 0.0046679373, 6.448397e-05, -0.00666508, 0.0050932234, 0.009138542, 0.01609962, 0.0030807706, 0.007559881, -0.0008407901, 0.023026677, 0.02806206, -0.009444748, 0.001132111, -0.0028902425, 0.01867175, 0.009192979, -0.0010649158, -0.0052054985, -0.027204685, -0.03252586, -0.006515379, -0.014085467, -0.029940123, 0.012071313, 0.029014701, -0.015568864, 0.021026133, 0.023679916, 0.013391401, -0.00051587174, 0.0021332337, 0.0019631195, 0.010948558, 0.009363093, -0.013098803, 0.014452914, -0.020835605, -0.012098531, -0.029695159, -0.021965163, 0.029804032, -0.024183454, 0.0071992385, 0.002965093, -0.011064236, -0.01483397, -0.0010164331, 0.027381603, -0.024006534, -0.007784432, 0.008437671, 0.046216663, 0.008260752, -0.0036744697, -0.03592815, 0.0045522596, -0.01403103, 0.021325532, -0.0008441924, 0.029422976, 0.019556344, 0.009764562, -0.022890585, 0.03415896, 0.036281984, -0.028252589, -0.009560426, -0.0022982447, 0.0035553896, 0.003783343, 0.019352207, -0.032172024, 0.033723466, 0.010785249, 0.010662766, -0.031818185, 0.016684813, 0.022917803, 0.0049163043, 0.020141536, -0.00016256551, 0.008560154, 0.0002760105, -0.005035384, 0.002196176, -0.0052973605, -0.012683725, -0.012908276, 0.019692436, -0.0073897666, 0.013207677, 0.015718564, -0.0033631604, 0.0048142355, -0.019529125, -0.030593362, 0.006280621, -0.019855745, 4.6967503e-05, -0.03241699, -0.009927873, -0.01435765, 0.0030297362, 0.021407187, -0.020794777, -0.010812467, 0.02121666, -0.024047362, -0.037860647, -0.00051672227, -0.024863912, -0.024918348, -0.007525858, -0.007655145, -0.0087779, -0.0043617315, 0.010029941, 0.013112413, -0.007355744, 0.006253403, -0.009247416, -0.037915085, 0.022223737, 0.03960262, 0.012275451, -0.04305934, 0.0049435226, -0.0039670663, 0.021883508, 0.0048108334, 0.023802398, -0.021679372, -0.037071317, 0.024755038, 0.021243878, -0.011921613, 0.011771912, 0.011098259, -0.014058249, 0.013534296, 0.019569954, 0.0016475574, -0.0042154333, -0.017120307, -0.0328797, 0.017623845, -0.024823084, 0.011458902, -0.041888952, 0.02392488, 0.017501364, -0.016848125, -0.00053926243, 0.0057974965, -0.0025976459, -0.01658955, -0.0055559343, 0.0079001095, 0.02393849, -0.008219925, 0.015800219, -0.02137997, 0.012758575, 0.016698424, 0.02568046, 0.010826076, 0.0021638544, -0.001731764, 0.02920523, -0.03426783, -0.0025347036, 0.007382962, -0.0018695565, 0.011710671, 0.016861733, -0.0033189307, -0.012758575, -0.007825259, 0.018140992, 0.0111731095, -0.012377519, 0.025939034, 0.014874797, -0.009512793, -0.012568047, 0.0034686313, 0.0109553635, 0.0242515, 0.02091726, -0.0015454887, 0.009261024, -0.010077573, 0.01690256, -0.010676376, 0.015269463, -0.0018797634, -0.009247416, -0.001981832, 0.015541646, 0.008151879, 0.033587374, -0.0037323085, 0.0075530764, 0.03380512, 0.018630922, -0.001862752, -0.009478771, 0.0013192367, -0.027857924, 0.03162766, 0.02040011, -0.022795321, -0.0136976065, 0.014167122, 0.035029944, 0.010410997, 0.015487209, 0.039684273, 0.011431683, -0.006954274, -0.00018563727, -0.018753404, 0.003039943, -0.000220936, -0.014398477, 0.0047087646, -0.0005856186, -0.034403924, -0.0025296002, -0.0031301037, 0.021883508, 0.019324988, 0.016467068, 0.007308112, 0.030919982, 0.023013067, -0.003786745, 0.0019188897, 0.016453458, -0.01612684, -0.008716659, -0.019039197, -0.00025878643, 0.015010889, -0.0059540016, -0.0018797634, 0.005572946, -0.018889496, -0.00574306, 0.014316822, 0.018630922, -0.022359828, 0.026238436, -0.015296681, -0.025285795, 0.017923247, 0.02792597, -0.016426241, -0.020468157, -0.026047908, 0.02487752, -0.02358465, -0.030974418, -0.010968972, -0.020835605, -0.005620578, 0.017964074, -0.0065902295, -0.01434404, -0.013282527, 0.011302397, 0.0069882968, -0.029069137, -0.0032100575, 0.01754219, 0.007879696, 0.0012954207, 0.0046543283, -0.010159228, 0.012459174, 0.08965706, 0.002728634, -0.0010734214, 0.024455637, -0.0030348396, 0.0061309207, -0.020726731, -0.014956452, -0.0048040287, -0.0053347857, 0.023952099, -0.0030756672, 0.01333016, 0.0042188354, -0.012813012, -0.016834514, 0.017800763, -0.03380512, 0.016521504, 0.018535659, 0.022387046, -0.008471694, -0.0073897666, 0.027640177, 0.0028766333, 0.033723466, -0.0023935088, 0.017433317, 0.01864453, -0.03728906, -0.005293958, 0.028470336, -0.0018117176, 0.018426785, 0.015174199, -0.0030297362, 0.017964074, -0.014126294, 0.021570498, -0.02759935, 0.01962439, 0.003562194, 0.017909637, 0.0019971423, 0.017133916, -0.03701688, -0.0025125886, -0.0033767696, 0.013255309, 0.0047053625, 0.016970607, 0.0102068605, -0.014439304, -0.009383507, 0.023489388, 0.00079698564, -0.0032712987, 0.0050115683, -0.016167667, -0.0069372626, -0.027449649, -0.021788243, 0.042487755, -0.019011978, -0.011275178, -0.018032119, -0.03568318, -0.00059369905, -0.026837237, 0.0056886235, 0.0022284978, -0.009682908, -0.017759936, 0.01690256, 0.022101255, 0.008240338, 0.005055798, 0.015963528, -0.0026197608, 0.026782801, -0.0057022325, -0.032961354, -0.0064507355, -0.015745783, -0.027150247, 0.0037186993, -0.008532935, -0.006443931, -0.023081113, -0.0064031035, 0.016766468, 0.021570498, 0.036581386, -0.025911815, 0.017460536, 0.03568318, 0.017038653, 0.03413174, 0.011275178, -0.01196244, 0.012186991, 0.0063792877, -0.016371803, -0.023053894, 0.029749595, 0.0016586147, -0.021026133, 0.015514428, -0.012397933, -0.005729451, 0.054654334, -0.026701147, 0.023502996, 0.021801854, -0.008219925, 0.029422976, -0.025449105, 0.019256942, 0.02614317, -0.00095944485, -0.012663311, -0.02792597, 0.043630924, 0.011438488, -0.030375615, 0.0069951015, 0.013507078, -0.0026316687, -0.027327167, -0.0034244016, -0.0055967616, 0.042950466, 0.012744966, -0.037152972, -0.025639633, -0.00837643, -0.0063894945, 0.019665217, 0.0038684, -0.0025364046, -0.018263474, 0.004331111, 0.029286884, -0.008192706, 0.012670116, -0.0150381075, 0.003203253, -0.0056546004, 0.012955908, 0.004589685, 0.011288787, -0.00538582, -0.026374526, -0.0050966255, 0.001280961, 0.005909772, -0.02553076, -0.009696517, 0.021611325, 0.019842137, 0.012493197, 0.0027235304, -0.0132417, 0.006273817, 0.011928417, 0.0020702914, -0.006811378, 0.011418074, -0.027340775, 0.035002727, 0.05468155, 0.0011185018, -0.011799131, 0.021665761, -0.025911815, 0.03013065, 0.010948558, -0.042351663, -0.03206315, -0.040555257, -0.0014689373, -0.011043822, -0.013085195, 0.018576486, -0.03443114, -0.008968428, -0.0009050083, -0.0033410455, 0.016562331, -0.023339687, 0.02025041, 0.008403648, -0.004259663, 0.013350573, -0.0026299676, -0.009846218, -0.014153513, -0.009784977, -0.012690529, -0.008907187, -0.002264222, 0.0030331386, 0.018045729, -0.010342952, 0.005521911, -0.01035656, -0.04752314, -0.020985303, 0.010826076, -0.010376974, 0.019011978, -0.0037357109, -0.03015787, -0.011125478, 0.011220741, 0.010635548, -0.010989386, 0.040446386, -0.02091726, -0.007001906, 0.017514972, -0.026088735, 0.004528444, 0.0022999458, -0.0051544644, 0.02233261, -0.024591729, -0.010968972, -0.030048996, 0.024319544, -0.026701147, 0.022155691, 0.04003811, -0.002386704, -0.011275178, 0.0018712577, 0.023911271, -0.011479315, -0.033369627, 0.027136639, -0.012486393, 0.005089821, 0.0020702914, 0.00075743406, -0.021148615, 0.032852482, -0.027517695, -0.02137997, 0.0013473055, -0.015065325, -0.014847579, -0.00019105966, -0.02074034, 0.022876976, 0.00094753684, -0.018236257, -0.008070224, 0.018236257, -0.02584377, -0.00932907, -0.013132826, 0.028198153, -0.007015515, 0.00434472, 0.0093018515, -0.004831247, -0.01077164, -0.0066412636, -0.008321993, 0.035166036, 0.0076007084, -0.021624934, 0.0061003002, 0.017950464, 0.012214209, 0.015010889, 0.0011661338, -0.008607785, -0.0057124393, 0.003261092, 0.012629288, 0.025762115, -0.03396843, -0.00025347035, -0.0075190538, -0.014561787, -0.003654056, -0.011799131, 0.0067467345, -0.037044097, -0.025925424, 0.011152696, 0.006610643, 0.007940937, -0.0025772322, 0.015596082, 0.012227818, 0.012697334, -0.035138816, 0.017433317, -0.022373438, 0.01364317, -0.015650518, 0.015065325, -0.03816005, -0.06450736, 0.018290693, 0.0055559343, -0.026524227, -0.012806207, 0.0063894945, 0.0034448153, 0.020645076, -0.03271639, 0.044910185, -0.0076891677, 0.0047495924, -0.026578663, -0.031682093, 0.002313555, 0.004759799, -0.0022778308, -0.0019171885, 0.0069236537, 0.0050115683, -0.009961896, 0.025911815, -0.015582473, -0.012255036, -0.014099076, 0.0044535934, 0.0142896045, -0.02456451, -0.005732853, 0.010097987, 0.00187466, -0.024156235, 0.026333699, 0.014262386, -0.030048996, -0.005164671, -0.003524769, 0.00956723, 0.035302125, -0.017025042, 0.0015488911, -0.022087645, -0.013336964, 0.004933316, -0.01752858, 0.008832336, 0.047931414, 0.0106423525, 0.003725504, -0.013493469, -0.0032678964, -0.0153239, 0.0017981086, -0.0003125851, 0.02120305, 0.0142896045, 0.005113637, 0.015990747, 0.00054861873, 0.0065902295, -0.0013847307, -0.024265109, 0.0083356025, 0.0069951015, 0.021924336, 0.016385412, 0.015337508, -0.02694611, 0.0069576763, 0.048366908, -0.014112685, 0.005409636, 0.011778717, -0.029259665, -0.0032764021, -0.024496464, -0.0064507355, -0.008458084, 0.0200871, 0.041453462, -0.015691346, -0.032661952, 0.019093633, 0.013507078, -0.023149159, -0.004630512, 0.02136636, 0.02121666, 0.0039602616, -0.0072400663, -0.0016739251, 0.01944747, 0.029395757, -0.0027150249, 0.013561515, 0.0008526981, 0.024292327, -0.008247143, -0.007852478, 0.008968428, -0.014643442, -0.0079001095, -0.024850301, 0.00626361, -0.01563691, -0.016671205, -9.5051386e-05, 0.01913446, 0.013398205, 0.018862277, -0.010220469, -0.018072948, -0.023013067, -0.00403171, -0.0015769599, 0.0064983675, -0.0072808936, -0.0020277628, -0.0306478, 0.0041575944, -0.0074918354, 0.005637589, 0.0038615954, -0.010404193, 0.019678826, 0.0057974965, -0.0021655555, -0.0038207679, -0.008832336, -0.00070002046, 0.011105063, 0.18933044, -0.004732581, -0.026238436, 0.017256398, -0.009744149, 0.006328253, -0.014915625, 0.013030758, 0.0057362556, 0.013826893, 0.0052531306, 0.006430322, -0.039330434, -0.003334241, -0.012976321, -0.016984215, -0.020985303, -0.04164399, -0.00048312472, -0.007219652, -0.01707948, 0.0054538655, -0.010159228, -0.013602342, 0.044719655, 0.025966251, -0.031872623, 0.0099687, 0.037370715, -0.014017421, 0.0066276547, -0.0054776818, -0.014548178, 0.010172837, -0.0117038665, 0.013268918, 0.004674742, -0.008390039, -0.009784977, 0.014738706, 0.005566141, 0.020127928, -0.010009527, 0.0050728093, 0.0022778308, -0.002194475, -0.01752858, -0.015582473, 0.005140855, 0.018072948, -0.032798044, 0.02105335, 0.012969517, 0.014561787, 0.035819273, 0.034512796, 0.0034141948, 0.009580839, 0.0021638544, 0.017923247, -0.012540828, 0.021815462, -0.042514976, 0.013990203, 0.0016450057, 0.018222647, 0.002339072, 0.044447474, -0.008675831, 0.0025091865, -0.018576486, -0.034703325, -0.016194886, 0.009989114, -0.02695972, -0.005031982, 0.029232448, 0.03162766, 0.017759936, 0.04706043, -0.019270552, 0.024850301, -0.035438217, -0.020100709, 0.006821585, -0.052694615, 0.0045114323, -0.0022540148, -0.00016968905, 0.019107241, 0.03140991, -0.028606426, -0.0074714217, -0.020019054, 0.029776813, 0.002766059, -0.010792053, 0.029314103, -0.021461625, 0.0015735576, -0.018590095, 0.06733806, -0.0030093226, 0.0084308665, -0.0062840236, -0.016739251, 0.019093633, 0.025639633, 0.01897115, -0.019583562, -0.012772184, -0.034213394, 0.013091999, -0.0024224282, 0.009526403, 0.011445292, 0.008070224, -0.010968972, 0.02358465, -0.01675286, -0.0026912089, -0.008920795, 0.014779533, 0.018249866, -0.011009799, 0.022196518, 0.028960265, -0.008648613, -0.0074918354, -0.030892763, 0.017161135, -0.038949378, 0.0050387867, -0.027980406, -0.01045863, -0.02120305, -0.00187466, -0.030838327, -0.014752315, -0.017637454, 0.0071039745, -0.0075326627, -0.0149428435, 0.002834105, 0.010200055, -0.022278173, 0.034077305, -0.010819272, -0.017474145, 0.035166036, -0.024972785, -0.010315733, 0.0077776276, -0.018943932, 0.026687536, -0.015881874, -0.052558526, -0.04787698, 0.0022693253, 0.008771095, -0.03783343, -0.003157322, 0.034567233, -0.03301579, 0.017583018, 0.016303757, -0.1712575, 0.02664671, 0.027612958, -0.011479315, 0.028579209, -0.003135207, -0.00047504427, -0.016548723, -0.01068318, 0.0042664674, 0.009546816, -0.016031574, -0.015133372, -0.004331111, -0.022890585, -0.01865814, 0.0021536474, 0.006882826, 0.024006534, -0.0038207679, 0.023040285, -0.009063692, -0.008982037, -0.005722646, -0.0090841055, -0.021638544, -0.014820361, 0.0022863366, 0.008757486, 0.008771095, 0.0046066963, -0.016249321, -0.0015080636, -0.019760482, 0.0059914268, 0.0052157054, -0.006110507, -0.007716386, -0.01819543, 0.0062091732, 0.03568318, 0.01819543, 0.005977818, -0.006716114, -0.026442572, 0.0011805935, 0.013622756, 0.012078118, 0.009880241, -0.0041371807, -0.012248232, -0.010785249, 0.007607513, -0.009077301, -0.00733533, -0.0111731095, -0.008458084, 0.009192979, -0.022210127, 0.0123503, -0.0015046613, -0.009247416, 0.0054028314, 0.025884597, -0.031682093, 0.005021775, -0.004239249, -0.0117038665, -0.014888407, -0.0005307567, -0.026551446, -0.017120307, -0.0033291376, -0.013881329, 0.026279263, -0.00091691624, 0.010329342, -0.0020090502, 0.00766195, -0.011350028, 0.029123574, 0.021815462, -0.010826076, -0.008498912, -0.004885684, 0.006443931, 0.029531848, 0.0022574172, 0.028252589, -0.019161679, 0.02728634, -0.018481221, 0.008015787, -0.01364317, 0.0015284773, 0.01882145, 0.012520415, -0.011663039, 0.013057976, -0.028307026, 0.015174199, 0.0067229187, -0.029695159, 0.0073965713, 0.03666304, -0.0019631195, 0.021638544, 0.0058961627, 0.04142624, -0.017610235, 0.0018117176, 0.032852482, 0.01898476, 0.029395757, 0.01672564, 0.0037969518, 0.006869217, 0.006267012, 0.012615679, -0.045672297, 0.05530757, 0.01124796, -0.027163858, 0.0047291787, 0.023258032, -0.014153513, -0.12749049, -0.06309201, 0.02725912, 0.033396848, -0.0026299676, 0.015010889, -0.015500818, 0.02233261, -0.0092406105, 0.0373435, -0.0035383783, -0.027231902, -0.004416168, -0.003356356, 0.018535659, 0.01212575, 0.00037999288, -0.048121944, 0.0039228364, 0.033832338, 0.024129018, 0.0011491224, -0.009029669, 0.010302125, -0.0007991121, -0.017977683, -0.015909093, -0.0060560703, 0.0019290965, 0.0010674675, 0.008594176, -0.032852482, 0.0027456454, -0.017365271, -0.015868265, 0.0006566413, -0.03639086, -0.01786881, 0.015568864, -0.0076891677, 0.014548178, 0.001946108, 0.0015080636, -0.017501364, -0.024673384, -0.019556344, -0.027585741, -0.013289331, -0.009859826, -0.013602342, -0.0015505921, -0.017664673, -0.024373982, -0.008417257, 0.020903649, -0.022686448, -0.009363093, 0.018698968, -0.01092134, -0.014412086, 0.007981764, -0.0064949654, -0.0016160862, 0.034730542, -0.018413175, -0.024047362, -0.03364181, 0.021026133, -0.020209583, -0.013609147, 0.008546544, 0.004518237, -0.010968972, -2.7377775e-05, -0.03941209, -0.011710671, -0.027163858, -0.010349756, -0.009192979, -0.006015243, -0.010166032, -0.0023986122, 0.011377247, -0.021080568, 0.006821585, 0.020195974, -0.0007157561, -0.0073761577, -0.009199783, -0.0077436045, 0.020236801, 0.014003812, -0.0034482176, 0.0029225643, 0.015596082, 0.0020362686, -0.008532935, -0.0018287291, 0.000984962, -0.016657596, -0.00363024, 0.013792871, -0.021761026, 0.0058349217, -0.0009084105, -0.014657051, 0.0054640723, -0.013935766, -0.014929234, -0.007879696, -0.00028643, -0.014425696, -0.029722376, -0.0029395758, 0.005977818, 0.0031130924, -0.020345675, -0.01864453, 0.0177055, -0.0059846225, 0.011193523, 0.022128472, -0.03494829, 0.0012163175, 0.0098938495, -0.0033971833, -0.011799131, -0.02074034, 0.0068658143, -0.00018733842, -0.015283071, -0.01371802, 0.023666305, -0.019529125, -0.0015854656, 0.007668754, 0.006222782, -0.009192979, -0.013425424, 0.0041235713, 0.008975232, 0.029450193, -0.03189984, -0.033369627, 0.00562398, -0.005372211, 0.0093018515, 0.0026248642, -0.032008715, 0.024292327, -0.009887045, -0.03323354, 0.026211217, 0.017324444, 0.010193251, -0.025612414, -0.012629288, -0.0026741973, -0.009737344, -0.010240883, 0.0072808936, -0.02074034, 0.021774635, 0.019692436, -0.03127382, -0.0059540016, 0.002242107, 6.8112186e-06, 2.4148261e-05, 0.04115406, -0.014616224, -0.0013974892, -0.019569954, 0.006161541, 0.0045998916, 0.007124388, 0.012989931, 0.0028204957, 0.007709582, 0.006362276, -0.02344856, 0.021910727, -0.0034618268, -0.0016126839, -0.014180731, 0.0009050083, -0.009553621, 0.014793143, -0.017596627, 0.011629016, 0.02358465, 0.025626024, -0.03315188, 0.009737344, -0.0018882691, -0.00916576, 0.03783343, 0.013724824, 0.0090841055, -0.0004414467, -0.0011848464, 0.00051842345, -0.024659773, -0.01578661, -0.01212575, -0.025898207, -0.012445564, 0.011268374, -0.022536747, -0.0066548726, 0.020032665, -0.005542325, -0.014765924, -0.0010189848, -0.010254492, 0.025612414, -0.04929233, -0.01212575, -0.0131056085, -0.03475776, -0.02280893, 0.022523139, 0.013187263, 0.025435496, 0.005766876, 0.023407733, -0.006443931, 0.0012180186, 0.004079342, -0.009574035, -0.0139153525, 0.009764562, -0.008321993, -0.0068079755, -0.022591183, -0.011241156, -0.009628471, -0.014058249, 0.014058249, 0.022849757, -0.01754219, 0.08143713, 0.012132554, 0.00019318609, 0.0112343505, -0.027953187, 0.012649702, 0.005521911, 0.0014289604, 0.0026044506, -0.028524771, 0.043767016, -0.019011978, 0.005974415, -0.00093733, -0.026537836, 0.008907187, -0.012112141, 0.0124183465, 0.00087864057, 0.0025721288, 0.02040011, -0.008566958, 0.032798044, 0.00813827, 0.006967883, 0.003381873, 0.02920523, -0.015609691, 0.00016394768, -0.014221558, 0.0023220608, 0.014126294, -0.02792597, 0.009043278, 0.036091458, -0.021407187, -0.023053894, 6.8909594e-06, -0.012935494, 0.003107989, 0.028742518, 0.0071924343, -0.011166305, -0.016807295, 0.007178825, -0.030430052, -0.032498643, 0.009995919, -0.012493197]::FLOAT[1536]) LIMIT %d) SELECT * FROM t0 JOIN ids ON CAST(docid AS INT)=id WHERE sel<%d", n, p);
	for (int i = 0; i < N; i++) {
		state = duckdb_query(con, query, &result);
		if (state == DuckDBError) {
			printf("unable to execute queries");
		}
		int resultn = duckdb_result_chunk_count(result);
		for (int i = 0; i < resultn; i++){
			duckdb_data_chunk chunk = duckdb_result_get_chunk(result, i);
			duckdb_destroy_data_chunk(&chunk);
		}
		duckdb_destroy_result(&result);
	}
	free(query);
}

*/
import "C"

func benchinit() {
	C.init()
}

func benchinitfaiss() {
	C.init_faiss()
}

func benchdeinitfaiss() {
	C.deinit_faiss()
}

func benchinitvss() {
	C.init_vss()
}

func benchdeinitvss() {
	C.deinit_vss()
}

func benchinitnovss() {
	C.init_novss()
}

func benchrun_post(N uint64, n, p uint32) {
	C.run_post(C.uint64_t(N), C.uint32_t(n), C.uint32_t(p))
}

func benchrun_postOne(N uint64, n, p uint32) {
	C.run_post_one(C.uint64_t(N), C.uint32_t(n), C.uint32_t(p))
}

func benchrun_sel(N uint64, p uint32) {
	C.run_sel(C.uint64_t(N), C.uint32_t(p))
}

func benchrun_set(N uint64, p uint32) {
	C.run_set(C.uint64_t(N), C.uint32_t(p))
}

func benchrun_post_vss(N uint64, n, p uint32) {
	C.run_post_vss(C.uint64_t(N), C.uint32_t(n), C.uint32_t(p))
}

func benchrun_post_novss(N uint64, n, p uint32) {
	C.run_post_novss(C.uint64_t(N), C.uint32_t(n), C.uint32_t(p))
}

